<!-- User Delete Modal Content -->
<div class="modal-header flex items-center justify-between p-6 border-b border-gray-200">
    <h3 class="text-lg font-semibold text-gray-900 text-red-600">
        <i class="fas fa-exclamation-triangle mr-2"></i>Delete User
    </h3>
    <button type="button" class="modal-close text-gray-400 hover:text-gray-600 transition-colors">
        <i class="fas fa-times text-xl"></i>
    </button>
</div>

<form id="userDeleteForm" method="post" action="{% url 'accounts:admin_user_delete_modal' user.id %}" class="modal-form">
    {% csrf_token %}
    <div class="modal-body p-6">
        <div class="flex items-start space-x-4">
            <div class="flex-shrink-0">
                <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                </div>
            </div>
            <div class="flex-1">
                <h4 class="text-lg font-medium text-gray-900 mb-2">Are you sure?</h4>
                <p class="text-sm text-gray-600 mb-4">
                    You are about to permanently delete the user account for:
                </p>
                
                <!-- User Information -->
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
                            <span class="text-white text-sm font-medium">{{ user.first_name.0|default:user.username.0|upper }}</span>
                        </div>
                        <div>
                            <div class="font-medium text-gray-900">{{ user.get_full_name|default:user.username }}</div>
                            <div class="text-sm text-gray-600">{{ user.email }}</div>
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                                {% if user.is_admin %}bg-purple-100 text-purple-800
                                {% elif user.is_staff_member %}bg-blue-100 text-blue-800
                                {% else %}bg-gray-100 text-gray-800{% endif %}">
                                {% if user.is_admin %}Admin
                                {% elif user.is_staff_member %}Staff
                                {% else %}Customer{% endif %}
                            </span>
                        </div>
                    </div>
                </div>

                <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-circle text-red-400"></i>
                        </div>
                        <div class="ml-3">
                            <h5 class="text-sm font-medium text-red-800">Warning</h5>
                            <div class="mt-1 text-sm text-red-700">
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>This action cannot be undone</li>
                                    <li>All user data will be permanently removed</li>
                                    <li>Any associated bookings and data will be affected</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>                <p class="text-sm text-gray-600">
                    Please type <strong class="font-semibold">{{ user.username }}</strong> to confirm deletion:
                </p>
                <input type="text" 
                       id="confirmUsername" 
                       name="confirm_username"
                       class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                       placeholder="Type username to confirm"
                       autocomplete="off"
                       data-expected-username="{{ user.username }}">
            </div>
        </div>
    </div>

    <div class="modal-footer flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50">
        <button type="button" class="modal-close px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
            Cancel
        </button>        <button type="submit" 
                id="confirmDeleteButton"
                data-username="{{ user.username }}"
                disabled
                class="px-4 py-2 text-sm font-medium text-white bg-gray-400 cursor-not-allowed border border-transparent rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="fas fa-trash mr-2"></i>Delete User
        </button>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const confirmInput = document.getElementById('confirmUsername');
    const deleteBtn = document.getElementById('confirmDeleteButton');
    
    if (confirmInput && deleteBtn) {
        const expectedUsername = confirmInput.getAttribute('data-expected-username');
        
        confirmInput.addEventListener('input', function() {
            const isMatch = this.value.trim() === expectedUsername;
            deleteBtn.disabled = !isMatch;
            
            if (isMatch) {
                deleteBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
                deleteBtn.classList.add('bg-red-600', 'hover:bg-red-700');
            } else {
                deleteBtn.classList.remove('bg-red-600', 'hover:bg-red-700');
                deleteBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
            }
        });

        // Also check on paste
        confirmInput.addEventListener('paste', function() {
            setTimeout(() => {
                const event = new Event('input');
                this.dispatchEvent(event);
            }, 10);
        });
    }
});
</script>
